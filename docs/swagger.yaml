basePath: /api
definitions:
  models.AppLogEntry:
    properties:
      after:
        description: new value
      before:
        description: previous value
      correlationId:
        description: link to event.id
        type: string
      error:
        type: string
      event:
        allOf:
        - $ref: '#/definitions/models.Event'
        description: for event type
      gameCode:
        type: string
      id:
        type: string
      leagueId:
        type: integer
      leagueName:
        type: string
      level:
        $ref: '#/definitions/models.AppLogLevel'
      message:
        type: string
      metric:
        description: for state_change
        type: string
      opponent:
        type: string
      source:
        type: string
      success:
        description: delivery result, if applicable
        type: boolean
      target:
        description: e.g., HA entity_id or event name
        type: string
      teamCode:
        type: string
      timestamp:
        type: string
      type:
        $ref: '#/definitions/models.AppLogType'
    type: object
  models.AppLogLevel:
    enum:
    - debug
    - info
    - warn
    - error
    type: string
    x-enum-varnames:
    - AppLogLevelDebug
    - AppLogLevelInfo
    - AppLogLevelWarn
    - AppLogLevelError
  models.AppLogType:
    enum:
    - event
    - state_change
    - log
    type: string
    x-enum-varnames:
    - AppLogTypeEvent
    - AppLogTypeStateChange
    - AppLogTypeLogLine
  models.BaseRunners:
    properties:
      first:
        $ref: '#/definitions/models.Player'
      second:
        $ref: '#/definitions/models.Player'
      third:
        $ref: '#/definitions/models.Player'
    type: object
  models.Broadcaster:
    properties:
      language:
        type: string
      name:
        type: string
      network:
        type: string
    type: object
  models.Event:
    properties:
      broadcasters:
        items:
          $ref: '#/definitions/models.Broadcaster'
        type: array
      clock:
        type: string
      description:
        type: string
      details:
        allOf:
        - $ref: '#/definitions/models.EventDetails'
        description: Event details
      gameCode:
        type: string
      gameId:
        type: string
      id:
        description: Basic event info
        type: string
      leagueId:
        description: Game context
        type: integer
      leagueName:
        type: string
      opponentCode:
        description: Opponent info
        type: string
      opponentHash:
        type: string
      opponentName:
        type: string
      period:
        type: integer
      playerName:
        type: string
      playerNumber:
        type: integer
      score:
        $ref: '#/definitions/models.ScoreUpdate'
      teamCode:
        description: Team and player info
        type: string
      teamHash:
        type: string
      teamName:
        type: string
      time:
        type: string
      timestamp:
        type: string
      type:
        $ref: '#/definitions/models.EventType'
      venue:
        allOf:
        - $ref: '#/definitions/models.Venue'
        description: Venue and broadcast info
    type: object
  models.EventDetails:
    properties:
      assist1:
        $ref: '#/definitions/models.Player'
      assist2:
        $ref: '#/definitions/models.Player'
      ballCount:
        type: integer
      baseRunners:
        allOf:
        - $ref: '#/definitions/models.BaseRunners'
        description: Enhanced baseball details
      bases:
        description: '"empty", "1st", "2nd", "3rd", "loaded"'
        type: string
      batter:
        $ref: '#/definitions/models.Player'
      distance:
        type: integer
      down:
        type: integer
      goalType:
        description: Goal details
        type: string
      inning:
        description: Baseball details
        type: integer
      outs:
        type: integer
      penaltyMinutes:
        type: integer
      penaltyType:
        description: Penalty details
        type: string
      pitchCount:
        type: integer
      pitcher:
        $ref: '#/definitions/models.Player'
      possession:
        description: Team code with possession
        type: string
      strikeCount:
        type: integer
      yardLine:
        description: Play details
        type: integer
      yardsGained:
        type: integer
    type: object
  models.EventType:
    enum:
    - goal
    - assist
    - penalty
    - power_play
    - shot
    - hit
    - faceoff
    - save
    - turnover
    - fumble
    - interception
    - touchdown
    - field_goal
    - safety
    - home_run
    - strikeout
    - walk
    - error
    - period_start
    - period_end
    - game_start
    - game_end
    type: string
    x-enum-varnames:
    - EventTypeGoal
    - EventTypeAssist
    - EventTypePenalty
    - EventTypePowerPlay
    - EventTypeShot
    - EventTypeHit
    - EventTypeFaceoff
    - EventTypeSave
    - EventTypeTurnover
    - EventTypeFumble
    - EventTypeInterception
    - EventTypeTouchdown
    - EventTypeFieldGoal
    - EventTypeSafety
    - EventTypeHomeRun
    - EventTypeStrikeout
    - EventTypeWalk
    - EventTypeError
    - EventTypePeriodStart
    - EventTypePeriodEnd
    - EventTypeGameStart
    - EventTypeGameEnd
  models.Game:
    properties:
      currentState:
        $ref: '#/definitions/models.GameState'
      events:
        items:
          $ref: '#/definitions/models.GameEvent'
        type: array
      extTimestamp:
        type: string
      gameCode:
        type: string
      gameDetails:
        allOf:
        - $ref: '#/definitions/models.GameDetails'
        description: Enhanced fields
      isFetching:
        type: boolean
      leagueId:
        type: integer
      statistics:
        $ref: '#/definitions/models.GameStats'
    type: object
  models.GameDetails:
    properties:
      broadcasters:
        items:
          $ref: '#/definitions/models.Broadcaster'
        type: array
      gameDate:
        type: string
      gameId:
        type: string
      gameTime:
        type: string
      officials:
        items:
          $ref: '#/definitions/models.Official'
        type: array
      season:
        type: string
      seasonType:
        type: string
      timezone:
        type: string
      week:
        type: integer
    type: object
  models.GameEvent:
    properties:
      clock:
        type: string
      description:
        type: string
      details:
        $ref: '#/definitions/models.EventDetails'
      id:
        type: string
      period:
        type: integer
      player:
        $ref: '#/definitions/models.Player'
      team:
        $ref: '#/definitions/models.Team'
      time:
        type: string
      timestamp:
        type: string
      type:
        $ref: '#/definitions/models.EventType'
    type: object
  models.GameState:
    properties:
      away:
        $ref: '#/definitions/models.TeamState'
      clock:
        type: string
      details:
        allOf:
        - $ref: '#/definitions/models.EventDetails'
        description: Baseball-specific details
      extTimestamp:
        type: string
      fetchedAt:
        type: string
      home:
        $ref: '#/definitions/models.TeamState'
      period:
        description: Enhanced game state
        type: integer
      periodType:
        description: '"REGULAR", "OVERTIME", "SHOOTOUT", etc.'
        type: string
      statistics:
        $ref: '#/definitions/models.TeamStats'
      status:
        type: integer
      timeRemaining:
        type: string
      venue:
        $ref: '#/definitions/models.Venue'
      weather:
        $ref: '#/definitions/models.Weather'
    type: object
  models.GameStats:
    properties:
      penalties:
        type: integer
      penaltyYards:
        type: integer
      timeOfPossession:
        type: string
      totalPlays:
        type: integer
      totalYards:
        type: integer
      turnovers:
        type: integer
    type: object
  models.Official:
    properties:
      name:
        type: string
      number:
        type: integer
      position:
        type: string
    type: object
  models.Player:
    properties:
      id:
        type: string
      name:
        type: string
      number:
        type: integer
      position:
        type: string
      team:
        $ref: '#/definitions/models.Team'
    type: object
  models.ScoreUpdate:
    properties:
      awayScore:
        type: integer
      awayTeam:
        type: string
      homeScore:
        type: integer
      homeTeam:
        type: string
    type: object
  models.Team:
    properties:
      extId:
        type: string
      leagueId:
        type: integer
      logoUrl:
        type: string
      teamCode:
        type: string
      teamId:
        type: integer
      teamName:
        type: string
    type: object
  models.TeamState:
    properties:
      periodScores:
        description: Enhanced team state
        items:
          type: integer
        type: array
      score:
        type: integer
      statistics:
        $ref: '#/definitions/models.TeamStats'
      team:
        $ref: '#/definitions/models.Team'
    type: object
  models.TeamStats:
    properties:
      baseballHits:
        description: MLB
        type: integer
      errors:
        type: integer
      faceoffs:
        type: integer
      firstDowns:
        description: |-
          League-specific stats
          NFL/CFL
        type: integer
      hits:
        type: integer
      passingYards:
        type: integer
      penalties:
        type: integer
      penaltyYards:
        type: integer
      plays:
        description: General stats
        type: integer
      powerPlays:
        type: integer
      rushingYards:
        type: integer
      shots:
        description: NHL
        type: integer
      strikeouts:
        type: integer
      timeOfPossession:
        type: string
      turnovers:
        type: integer
      walks:
        type: integer
      yards:
        type: integer
    type: object
  models.Venue:
    properties:
      capacity:
        type: integer
      city:
        type: string
      country:
        type: string
      id:
        type: string
      indoor:
        type: boolean
      name:
        type: string
      state:
        type: string
      surface:
        type: string
    type: object
  models.Weather:
    properties:
      condition:
        type: string
      humidity:
        type: integer
      temperature:
        type: integer
      windDirection:
        type: string
      windSpeed:
        type: integer
    type: object
  webApi.ApiResponse:
    properties:
      data: {}
      message:
        type: string
      success:
        type: boolean
    type: object
  webApi.haConfigBody:
    properties:
      accessToken:
        example: your-long-lived-access-token
        type: string
      clearToken:
        example: false
        type: boolean
      url:
        example: http://homeassistant.local:8123
        type: string
    type: object
host: localhost:8080
info:
  contact:
    name: API Support
    url: https://github.com/yourusername/goalfeed/issues
  description: |-
    Real-time sports monitoring API for NHL, MLB, NFL, CFL, and IIHF games.
    Provides game state, events, and team management for Home Assistant integration and web consumers.
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: http://swagger.io/terms/
  title: Goalfeed API
  version: "1.0"
paths:
  /clear:
    post:
      consumes:
      - application/json
      description: Clears all games from the memory store. Useful for testing and
        resetting state.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
      summary: Clear all games
      tags:
      - games
  /debug/nfl/add:
    post:
      consumes:
      - application/json
      description: Force-adds an NFL game by ESPN event ID. Debug endpoint for testing.
      parameters:
      - description: ESPN event ID
        in: query
        name: event
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/webApi.ApiResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.Game'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
      summary: Add NFL game (Debug)
      tags:
      - debug
  /events:
    get:
      consumes:
      - application/json
      description: Returns a filtered list of game events (goals, scores, etc.) with
        optional filters
      parameters:
      - description: Filter by league ID (1=NHL, 2=MLB, 5=CFL, 6=NFL)
        in: query
        name: leagueId
        type: integer
      - description: Filter by team code
        in: query
        name: team
        type: string
      - description: Filter events since timestamp (RFC3339)
        in: query
        name: since
        type: string
      - description: 'Maximum number of events to return (default: 50)'
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/webApi.ApiResponse'
            - properties:
                data:
                  items:
                    type: object
                  type: array
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
      summary: Get events
      tags:
      - events
  /games:
    get:
      consumes:
      - application/json
      description: Returns a list of all currently active games across all monitored
        leagues
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/webApi.ApiResponse'
            - properties:
                data:
                  items:
                    $ref: '#/definitions/models.Game'
                  type: array
              type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
      summary: Get all active games
      tags:
      - games
  /homeassistant/config:
    get:
      consumes:
      - application/json
      description: Returns the current Home Assistant configuration (URL and token
        status)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/webApi.ApiResponse'
            - properties:
                data:
                  type: object
              type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
      summary: Get Home Assistant configuration
      tags:
      - homeassistant
    post:
      consumes:
      - application/json
      description: Updates the Home Assistant URL and access token for integration
      parameters:
      - description: Home Assistant configuration
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/webApi.haConfigBody'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
      summary: Update Home Assistant configuration
      tags:
      - homeassistant
  /homeassistant/status:
    get:
      consumes:
      - application/json
      description: Checks the connection status to Home Assistant and returns configuration
        details
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/webApi.ApiResponse'
            - properties:
                data:
                  type: object
              type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
      summary: Get Home Assistant connection status
      tags:
      - homeassistant
  /leagues:
    get:
      consumes:
      - application/json
      description: Returns the list of all supported leagues and their monitored teams
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/webApi.ApiResponse'
            - properties:
                data:
                  items:
                    type: object
                  type: array
              type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
      summary: Get league configurations
      tags:
      - leagues
    post:
      consumes:
      - application/json
      description: Updates the list of monitored teams for a specific league
      parameters:
      - description: League configuration
        in: body
        name: body
        required: true
        schema:
          properties:
            leagueId:
              type: integer
            teams:
              items:
                type: string
              type: array
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
      summary: Update league configuration
      tags:
      - leagues
  /logs:
    get:
      consumes:
      - application/json
      description: Returns application logs with optional filters for debugging and
        monitoring
      parameters:
      - description: Filter by league ID
        in: query
        name: leagueId
        type: integer
      - description: Filter by team code
        in: query
        name: team
        type: string
      - description: Filter logs since timestamp (RFC3339)
        in: query
        name: since
        type: string
      - description: Maximum number of log entries to return (0 = all)
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/webApi.ApiResponse'
            - properties:
                data:
                  items:
                    $ref: '#/definitions/models.AppLogEntry'
                  type: array
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
      summary: Get application logs
      tags:
      - logs
  /refresh:
    post:
      consumes:
      - application/json
      description: Triggers a refresh of all active games from external APIs
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
      summary: Refresh active games
      tags:
      - games
  /teams:
    get:
      consumes:
      - application/json
      description: Returns a list of all teams for a specific league with logos and
        metadata
      parameters:
      - description: League ID (1=NHL, 2=MLB, 5=CFL, 6=NFL)
        in: query
        name: leagueId
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/webApi.ApiResponse'
            - properties:
                data:
                  items:
                    type: object
                  type: array
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
      summary: Get all teams for a league
      tags:
      - teams
  /upcoming:
    get:
      consumes:
      - application/json
      description: Returns a list of upcoming games for monitored teams within the
        next 7 days
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/webApi.ApiResponse'
            - properties:
                data:
                  items:
                    $ref: '#/definitions/models.Game'
                  type: array
              type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/webApi.ApiResponse'
      summary: Get upcoming games
      tags:
      - games
schemes:
- http
- https
swagger: "2.0"
